#*************************************************************************
#	Appli	：HTML Help Workshop補助ツール
#	Module	：hhpファイルにコンパイルオプションを追加する
#	File	：hhpopt.pl
#	Date	：2007-01-07
#	Author	：石川達也
#*************************************************************************
#=========================================================================
#	機能
#=========================================================================
#	HTML Help Workshopのプロジェクトファイルを編集する。
#
#-------------------------------------------------------------------------
#	変更履歴
#-------------------------------------------------------------------------
#	2007-01-07	新規作成
#-------------------------------------------------------------------------
#=========================================================================
#	メイン
#=========================================================================
# 変数初期化
$flg = 0;


# hhpファイル名取得
$hhpfile = $ARGV[0];
if ($hhpfile eq "") {
	die("hhpファイルを指定してください。\n");
}


if (!open( HHP, $hhpfile)) {
	die("hhpファイルの読み込みに失敗しました。\n");
}

# HHPを編集
while(<HHP>) {
	if ($_ =~ /\[OPTIONS\]/) {
		# バイナリインデックスを作成しない
		$_ .= "Binary Index=No\n";
		$flg = 1;
	}

	print $_;
}

close(HHP);
exit();
